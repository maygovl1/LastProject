package kr.or.navi.vo;

import java.io.IOException;
import java.io.Serializable;
import java.io.UncheckedIOException;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.time.temporal.ChronoUnit;
import java.util.Base64;
import java.util.List;

import org.apache.commons.lang3.StringUtils;
import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.format.annotation.DateTimeFormat.ISO;
import org.springframework.web.multipart.MultipartFile;

import lombok.Data;
import lombok.EqualsAndHashCode;
import lombok.ToString;

@Data
@EqualsAndHashCode(of="empId")
public class EmpVO implements Serializable{
	private String empId;
	private String deptId;
	private String deptName;
	private String psId;
	private String psName;
	private String roleId;
	private String cnId;
	private String empName;
	private Integer empAge;
	private String empGen;
	private String empPass;
	private String empRrno;
	private String empPhone;
	@ToString.Exclude
	private String empTel;
	@ToString.Exclude
	private String empZip;
	@ToString.Exclude
	private String empAddr;
	@ToString.Exclude
	private String empAddr2;
	@ToString.Exclude
	private String empMail;
	@DateTimeFormat(iso = ISO.DATE_TIME)
	private LocalDateTime empCmpYmd;
	private Integer empCareer;
	private LocalDateTime empQuitDt;
	private String empLimitYn;
	private String empBkId;
	private String empFmId;
	private Integer empCertCg;
	private String roomId;
	private String lastChat;
	private LocalDateTime lastChatSendDt;
	private List<String> empRoles; // Team 테이블의 Role ID 리스트
	private List<ProjectVO> projectList;
	private String empImg;
	private byte[] empImage;
	private MultipartFile bpAttchFile;
	public void setBpAttchFile(MultipartFile bpAttchFile) {
		if(bpAttchFile==null || bpAttchFile.isEmpty()) return;
		this.bpAttchFile = bpAttchFile;
		try {
			this.empImage = bpAttchFile.getBytes();
		} catch (IOException e) {
			throw new UncheckedIOException(e);
		}
	}
	public String getBase64Img() {
		if(empImage==null) return null;
		else 
			return Base64.getEncoder().encodeToString(empImage);
	}
	public String getEmpGenStr() {
		if (("F").equals(empGen)) {
	        return "여자";
	    } else if (("M").equals(empGen)) {
	        return "남자";
	    } else {
	        return "알 수 없음"; // 예외 처리: F나 M이 아닌 다른 값일 경우
	    }
	}
	public String getRoleId() {
		if(StringUtils.isNotBlank(roleId))
		return roleId.trim();
		
		return null;
	}
	public String getEmpCmpYmdStr() {
		if(empCmpYmd!=null)
			return empCmpYmd.format(DateTimeFormatter.ISO_DATE);
		return null;
	}
	public boolean isAdmin() {
		return "ROLE_ADMIN".equals(roleId);
	}

	public String getlastChatSendDtStr() {
		if(lastChatSendDt!=null)
			return lastChatSendDt.format(DateTimeFormatter.ISO_DATE);
		return null;
	}
	
}
