<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.navi.board.share.dao.ShareDAO">
	
	
	<select id="selectShareList" resultType="BoardPostVO" parameterType="PaginationInfo">
		SELECT B.* FROM(
			SELECT ROWNUM RNUM, A.* FROM (
				SELECT
					bp_id
					, EMP.emp_name
					, bp_title
					, bp_reg_dt
					, share_stat.shr_name
					, bp_cnt
				FROM
					board_post
				JOIN
					EMP ON(board_post.emp_id = emp.emp_id)
                JOIN
                    SHARE_STAT ON(board_post.bp_shr_yn = share_stat.bp_shr_yn)
				WHERE
					BRD_ID = 'BN0006'
					AND bp_del_dt IS NULL
				ORDER BY 
					BP_REG_DT DESC
			) A
		) B
	</select>
	
	<select id="totalRecord" parameterType="PaginationInfo">
		select COUNT(*)FROM
				(
					SELECT
						bp_id
						, EMP.emp_name
						, bp_title
						, bp_reg_dt
						, bp_shr_yn
						, bp_cnt
					FROM
						board_post
					JOIN
						EMP ON(board_post.emp_id = emp.emp_id)
					WHERE
						BRD_ID = 'BN0006'
						AND bp_del_dt IS NULL
					ORDER BY 
						BP_REG_DT DESC
				) A
			
	
	</select>
	
	<select id="selectShare" resultMap="shareMap">
		SELECT
			bp_id
		  , share_stat.shr_name
		  , EMP.emp_Name
		  , bp_title
		  , bp_cn
		  , bp_reg_dt
		  , bp_del_dt
		  , bp_mod_id
		  , bp_mod_dt
		  , bp_cnt
		FROM
		    board_post
		JOIN
		    EMP ON(board_post.emp_id = emp.emp_id)
		JOIN
		    SHARE_STAT ON(board_post.bp_shr_yn = share_stat.bp_shr_yn)
		WHERE
		    BRD_ID = 'BN0006'
		    AND BP_ID = #{bpId}
			
	</select>
	<resultMap type="BoardPostVO" id="shareMap" autoMapping="true">
		<id column="BP_ID" property="bpId" />
		<result column="BP_CN" property="bpCn" jdbcType="CLOB" />
	</resultMap>
	
	
	
</mapper>