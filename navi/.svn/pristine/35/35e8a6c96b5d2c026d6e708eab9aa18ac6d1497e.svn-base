const cPath = document.body.dataset.contextPath;

function getCsrfToken() {
    return document.querySelector('meta[name="_csrf"]').getAttribute('content');
}

function getCsrfHeader() {
    return document.querySelector('meta[name="_csrf_header"]').getAttribute('content');
}

$(".bookMark").on("click", function(e) {
    e.preventDefault(); // 기본 이벤트 방지

    const issueId = $(this).data("mark-id");
    const url = cPath + "/mypage/bookmark";

    fetch(url, {
        method: "POST",
        headers: {
            "Accept": "application/json",
            "Content-Type": "application/json", // JSON 형식의 요청을 보냄
            [getCsrfHeader()]: getCsrfToken()
        },
        body: JSON.stringify({
            issueId: issueId
			, empId: empId
			, proId: proId
			, biRegDt: DEFUALT
			, biDelDt: NULL
			
        })
    }).then(resp => {
        if (resp.ok) {
            // 응답이 정상적인 경우, ".bookMark" 요소의 클래스를 토글함
            $(this).toggleClass("active");
            return resp.text(); // 응답 텍스트 반환
        } else {
            throw new Error(`상태코드 ${resp.status} 수신`, { cause: resp });
        }
    }).then(text => {
        console.log(text);
    }).catch(err => {
        console.error(err);
    });
});